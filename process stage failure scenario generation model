SETS
i      resource /1*36/
p      technology type /1,2,3,4,5,9,10,11,12,13,14,15,16,17,18,19,22,23,27/
f      objective function /1,2,3,4,5,6/
int    intermediate stream /lpspom, lpspor, mpspor, wpom, wpor, effpor/
ps     industrial pipe diameter from 24 to 0.5 inch /24   ,     22    ,    20   ,     18    ,    16   ,     14    ,    12    ,    10   ,     8    ,    6   ,     4   ,     3  ,      2   ,     1h     ,   1   ,     3q    ,    h  /
sz     process failure scenario z /1*63/
;

Parameter  pexist_AUX(p), correlated_AUX(p), bypass_AUX(p), pfirst_AUX, exgenres_AUX(i), exprores_AUX(i), addbyind_AUX(i),excpo_AUX(p),pint_AUX(int),rforce_AUX(i),Model_Objective(sz);

pexist_AUX(p) = 0;
correlated_AUX(p) = 0;
bypass_AUX(p) = 0;
pfirst_AUX = 0;
exgenres_AUX(i) = 0;
exprores_AUX(i) = 0;
addbyind_AUX(i) = 0;
excpo_AUX(p)= 0 ;
pint_AUX(int) = 0;
rforce_AUX(i) = 0;
Model_Objective(sz) = 0;

Parameter
ceff        BOD of effluent discharged /40/
cact        BOD of actual water supply /30/
cmax        Maximum BOD for discharged effluent /100/
cnat        Natural BOD at waterways /1/
GEF         grid emission factor (kgCO2e per MWH grid electricity) /543/
AOT         annual operating hours /  4350  /
elecprice   price for exporting elec / 0 /
electariff  electricity tariff / 91.2 /
uetranscost  capital cost for transmission line (USD per km per MW) /967/
cpocost     corrected to 0.23 RMtoUSD conversion /1012.115/
gamma       relatively small number  /0.00001/
alpha       relatively large number  /100000/
MCF         maintenance cost factor /0.03/
FiT         FiT rate for biogas or biomass electricity (79.6)  /0/

uintpcost(int)   pipeline capital cost based on inch pipe diameter and pipeline length in m
/

lpspor     105.98
wpor       48.88
effpor     28.895

/

pfirst(sz)   Ind_PFIRST binary indicator for scenario z meeting the minimum processing capacity limits
/
1         1
2         1
3         0
4         0
5         0
6         1
7         1
8         1
9         1
10        1
11        1
12        1
13        1
14        1
15        1
16        0
17        0
18        1
19        0
20        1
21        1
22        1
23        1
24        1
25        1
26        1
27        1
28        1
29        1
30        1
31        1
32        1
33        1
34        1
35        1
36        1
37        1
38        0
39        1
40        1
41        1
42        1
43        1
44        1
45        1
46        1
47        1
48        1
49        1
50        1
51        1
52        1
53        1
54        1
55        1
56        1
57        1
58        1
59        1
60        1
61        1
62        1
63        1


/

elecind(i)          resource indicator for electricity as utility
/
         31               1
/

effind(i)          resource indicator for effluent to be treated
/
         2                1
         8                1
         21               1
/

fwind(i)          resource indicator for resource originated from fresh water
/
         24               1
/

uextcost(i)          unit price of processing resource i at external location (USD per t)
       /
         1                0
         2                0.87
         3                7.22
         5                0.41
         6                2.09
         7                0.99
         11               2.04
         20               1.30
/

pcoeff(int)    coefficient from flowrate of intermediate stream int to pipe diameter square

/
lpspor         0.008177
wpor           0.000337
effpor         0.000449
mpspor         0.001761
/

disint(int)    length of pipeline for intermediate stream int

/
lpspor         100
wpor           100
effpor         100
mpspor         100
/

localavres(i)          basic amount of available stock feed i (t per h)
       /
         1                60
         2                0
         3                0
         11               0.00000001
         12               0
         14               0
         16               3.437
         24               100
         29               0.5
         30               0.5    /

dempro(i)    demand of product i  (tons per year)
       /
         1                0
         2                0
         3                0
         4                0
         11               0
         25               0
         26               0
         27               0       /

price(i)        unit price of product i ($ per ton)
     /
         1                0
         2                0
         3                0
         4                6
         9                0
         11               1012.115
         12               0
         14               23
         16               45
         17               665.52
         18               43
         22               0
         23               0
         24               0
         25               0
         26               0
         29               0
         30               0
         25               1146
         26               1107.5
         27               1020.5
         32               0
         34               2            /

urcost(i)        unit importing cost of resource i ($ per ton or per MWh)
     /
         1                0
         2                0
         3                0
         4                0
         11               1012.115
         12               18.26
         14               23
         16               45
         17               665.52
         21               0
         24               0.69
         31               0
         29               18
         30               12 /

descap(p)    unit design capacity of process p      /


          1                20
          2                40
          3                20
          4                25
          5                20
          9                10
          10               10
          11               10
          12               24
          13               10
          14               3.5
          16               0
          17               0
          18               1
          19               0.5
          22               15
          23               20
          27               30

  /

maxcap(p)     maximum unit of operating process p      /


          1                3
          2                2
          3                3
          4                2
          5                2
          9                2
          10               2
          11               1
          12               1
          13               2
          14               1
          16               100
          17               100
          18               2
          19               1
          22               1
          23               1
          27               2

  /


uopex(p)     unit processing cost for process p  ($ per unit)    /


          1                180000
          2                33750
          3                15000
          4                36000
          5                35000
          9                25000
          10               36000
          11               13000
          12               13050
          13               55000
          14               180000
          18               3308
          19               2447
          22               3784500
          27               80000


   /


uelecdem(p)     unit electricity dem for process p  (MW per unit)    /


          1                0.0754
          2                0.028
          3                0.018
          4                0.040
          5                0.05
          9                0.0686
          10               0.0311
          11               0.0292
          12               0.1625
          13               0.035
          14               0.0714
          18               0
          22               1.5
          27               0

  /

byind(i)     Rind_PRO product or byproduct indicator      /


          1                0
          2                0
          3                0
          4                1
          5                0
          6                0
          7                0
          8                1
          9                0
          10               0
          11               0
          12               0
          13               0
          14               0
          15               0
          16               0
          17               1
          18               1
          19               0
          20               0
          21               1
          22               0
          23               0
          24               1
          25               1
          26               1
          27               1
          28               0
          29               1
          30               1
          31               1
          32               1
          33               0
          34               1
          35               1
          36               1
 /

ghgresind(i)     REF_GHGRES ghg-emitting external resource indicator (kgCO2e per t resource)   /

          14               5.49
          16               5.49
          24               0.34
          25               0
          26               0
          27               0
          28               0
          29               269.22
          30               266.37
          31               543
/

ghgproind(i)     REF_GHGPRO ghg-emitting product indicator (kgCO2e per t resource)   /

          2                337.6
/

Table    externalpol(i,p)     Mind_EXT for intermediate material i in core process p to be processed externally

                 1        2        3        4        5        13
3                1        0        0        0        0        0
5                0        1        0        0        0        0
6                0        0        1        0        0        0
7                0        0        0        1        0        0
11               0        0        0        0        0        1

;

Table    mcm(i,p)     the amount of input material i to process p

                          1       2        3       4       5             9       10    11    12   13     14      15    16     17    18     19         22     23        27
          1               1       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          2               0       0        0       0       0             0       0     0     1    0      0       0     0      0     0      0          0      0         0
          3               0       1        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          4               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          5               0       0        1       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          6               0       0        0       1       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          7               0       0        0       0       1             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          8               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          9               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         10               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         11               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          1      0         0
         12               0       0        0       0       0             1       0     0     0    0      0       0     0      0     0      0          0      0         0
         13               0       0        0       0       0             0       1     0     0    0      0       0     0      0     0      0          0      0         0
         14               0       0        0       0       0             0       0     0     0    0      0       0     1      0     0      0          0      0         0
         15               0       0        0       0       0             0       0     1     0    0      0       0     0      0     0      0          0      0         0
         16               0       0        0       0       0             0       0     0     0    0      0       0     0      1     0      0          0      0         0
         17               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         18               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         19               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      1         0
         20               0       0        0       0       0             0       0     0     0    1      0       0     0      0     0      0          0      0         0
         21               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         22               0       0        0       0       0             0       0     0     0    0      1       0     0      0     0      0          0      0         0
         23               0       0        0       0       0             0       0     0     0    0      0       1     0      0     0      0          0      0         0
         24               0       0        0       0       0             0       0     0     0    0      0       0     2.599  3.456 0      0          0.33   0         0
         25               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         26               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         27               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         28               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         29               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      1          0.025  0         0
         30               0.25    0        0.13    0       0             0       0     0     0.25 0      0.4     0     0      0     0      0          0.03   0         0
         31               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         32               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         33               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         1
         35               0       0        0       0       0             0       0     0     0    0      0       0     0      0     1      0          0      0         0
         36               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
   ;

Table    prcm(i,p)     output yield of product i from process p
                          1       2        3       4       5         9       10    11    12    13     14      15    16     17                  18            22    23          19           27
          1               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          2               0.211   0        0       0       0.33      0       0     0     0     0      0       0     0      0                   0             0     1           0            0
          3               0.8997  0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          4               0       0.24     0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          5               0       0.76     0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          6               0       0        1.04    0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          7               0       0        0       0.60    0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          8               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          9               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         10               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         11               0       0        0       0       0         0       0     0     0     0.93   0       0     0      0                   0             0     0           0            0
         12               0       0        0       0.40    0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         13               0       0        0       0       0         0.59    0     0     0     0      0       0     0      0                   0             0     0           0            0
         14               0       0        0       0       0         0.41    0     0.19  0     0      0       0     0      0                   0             0     0           0            0
         15               0       0        0       0       0         0       0.99  0     0     0      0       0     0      0                   0             0     0           0            0
         16               0       0        0       0       0         0       0     0.357 0     0      0       0     0      0                   0             0     0           0            0
         17               0       0        0       0       0         0       0     0.453 0     0      0       0     0      0                   0             0     0           0            0
         18               0       0        0       0       0.09      0       0     0     0     0      0.97    0     0      0                   0             0     0           0            0
         19               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0.175 0           0            0
         20               0       0        0       0       0.58      0       0     0     0     0      0.03    0     0      0                   0             0     0           0            0
         21               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         22               0       0        0       0       0         0       0     0     0.143 0      0       0     0      0                   0             0     0           0            0
         23               0       0        0       0       0         0       0     0     0.853 0      0       0     0      0                   0             0     0           0            0
         24               0       0        0       0       0         0       0     0     0     0      0       0.7   0      0                   0             0     0           0            0
         25               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0.76  0           0            0
         26               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0.19  0           0            0
         27               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0.05  0           0            0
         28               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         29               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   1             0     0           0            0
         30               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           1            0
         31               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0.0332        0     0           0.0079       0
         32               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         33               0       0        0       0       0         0       0     0     0     0      0       0     2.599  3.456               0             0     0           0            0
         34               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         35               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            1
         36               0       0        0       0       0         0       0.01  0     0     0.07   0       0     0      0                   0             0     0           0            0
  ;

Table    relprind(i,p)     PRind_REL intermediate resource i to be considered in correlated process p
                          1       2        3       4       5         9       10    11    12    13     14      15    16     17                  18            22    23          19           27
          1               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          2               1       0        0       0       1         0       0     0     0     0      0       0     0      0                   0             0     1           0            0
          3               1       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          4               0       1        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          5               0       1        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          6               0       0        1       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          7               0       0        0       1       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          8               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
          9               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         10               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         11               0       0        0       0       0         0       0     0     0     1      0       0     0      0                   0             0     0           0            0
         12               0       0        0       1       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         13               0       0        0       0       0         1       0     0     0     0      0       0     0      0                   0             0     0           0            0
         14               0       0        0       0       0         1       0     1     0     0      0       0     0      0                   0             0     0           0            0
         15               0       0        0       0       0         0       1     0     0     0      0       0     0      0                   0             0     0           0            0
         16               0       0        0       0       0         0       0     1     0     0      0       0     0      0                   0             0     0           0            0
         17               0       0        0       0       0         0       0     1     0     0      0       0     0      0                   0             0     0           0            0
         18               0       0        0       0       1         0       0     0     0     0      1       0     0      0                   0             0     0           0            0
         19               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             1     0           0            0
         20               0       0        0       0       1         0       0     0     0     0      1       0     0      0                   0             0     0           0            0
         21               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         22               0       0        0       0       0         0       0     0     1     0      0       0     0      0                   0             0     0           0            0
         23               0       0        0       0       0         0       0     0     1     0      0       0     0      0                   0             0     0           0            0
         24               0       0        0       0       0         0       0     0     0     0      0       1     0      0                   0             0     0           0            0
         25               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             1     0           0            0
         26               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             1     0           0            0
         27               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             1     0           0            0
         28               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         29               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   1             0     0           0            0
         30               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           1            0
         31               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   1             0     0           1            0
         32               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         33               0       0        0       0       0         0       0     0     0     0      0       0     1      1                   0             0     0           0            0
         34               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            0
         35               0       0        0       0       0         0       0     0     0     0      0       0     0      0                   0             0     0           0            1
         36               0       0        0       0       0         0       1     0     0     1      0       0     0      0                   0             0     0           0            0
  ;

Table    pextres(i,p)     AVRES_PEXT Additional amount of intermediate resource i made available during failure of process p (t per h)
                          1       2        3       4       5      9       10    11           12    16     17      18           13       14      15
          1               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          2               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          3               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          4               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          5               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          6               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          7               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          8               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
          9               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         10               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         11               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         12               0       0        0       11.947  0      0       0     0            0     0      0       0             0       0       0
         13               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         14               0       0        0       0       0      0       0     6.224        0     0      0       0             0       0       0
         15               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         16               0       0        0       0       0      0       0     2.491        0     0      0       0             0       0       0
         17               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         18               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         19               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         20               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         21               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         22               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         23               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         24               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         25               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         26               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         27               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         28               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         29               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         30               0       0        0       0       0      0       0     0            0     0      0       50            0       0       0
         31               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         32               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0
         33               0       0        0       0       0      0       0     0            0     0      0       0             0       0       0

  ;

Table    bymcm(i,p)     MCM_BY unconsumed material i in by-passed process p

                          1       2        3       4       5             9       10    11    12   13     14      15    16     17    18     19         22     23        27
          1               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          2               0       0        0       0       0             0       0     0     1    0      0       0     0      0     0      0          0      0         0
          3               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          4               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          5               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          6               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          7               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          8               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
          9               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         10               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         11               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          1      0         0
         12               0       0        0       0       0             1       0     0     0    0      0       0     0      0     0      0          0      0         0
         13               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         14               0       0        0       0       0             0       0     0     0    0      0       0     1      0     0      0          0      0         0
         15               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         16               0       0        0       0       0             0       0     0     0    0      0       0     0      1     0      0          0      0         0
         17               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         18               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         19               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         20               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         21               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         22               0       0        0       0       0             0       0     0     0    0      1       0     0      0     0      0          0      0         0
         23               0       0        0       0       0             0       0     0     0    0      0       1     0      0     0      0          0      0         0
         24               0       0        0       0       0             0       0     0     0    0      0       0     2.599  3.456 0      0          0.33   0         0
         25               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         26               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         27               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         28               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         29               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      1          0.025  0         0
         30               0.25    0        0.13    0       0             0       0     0     0.25 0      0.4     0     0      0     0      0          0.03   0         0
         31               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         32               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         0
         33               0       0        0       0       0             0       0     0     0    0      0       0     0      0     0      0          0      0         1
         35               0       0        0       0       0             0       0     0     0    0      0       0     0      0     1      0          0      0         0
   ;

Table    byprcm(i,p)     PRCM_BY Loss of product i from by-passed process p
                          1       2        3       4       5      9       19      10      13
          1               0       0        0       0       0      0       0       0       0
          2               1       0        0       0       1      0       0       0       0
          3               0       0        0       0       0      0       0       0       0
          4               0       1        0       0       0      0       0       0       0
          5               0       0        0       0       0      0       0       0       0
          6               0       0        0       0       0      0       0       0       0
          7               0       0        0       0       0      0       0       0       0
          8               0       0        0       0       0      0       0       0       0
          9               0       0        0       0       0      0       0       0       0
         10               0       0        0       0       0      0       0       0       0
         11               0       0        0       0       0      0       0       0       0
         12               0       0        0       1       0      0       0       0       0
         13               0       0        0       0       0      1       0       0       0
         14               0       0        0       0       0      1       0       0       0
         15               0       0        0       0       0      0       0       0       0
         16               0       0        0       0       0      0       0       0       0
         17               0       0        0       0       0      0       0       0       0
         18               0       0        0       0       1      0       0       0       0
         19               0       0        0       0       0      0       0       0       0
         20               0       0        0       0       0      0       0       0       0
         21               0       0        0       0       0      0       0       0       0
         22               0       0        0       0       0      0       0       0       0
         23               0       0        0       0       0      0       0       0       0
         24               0       0        0       0       0      0       0       0       0
         25               0       0        0       0       0      0       0       0       0
         26               0       0        0       0       0      0       0       0       0
         27               0       0        0       0       0      0       0       0       0
         28               0       0        0       0       0      0       0       0       0
         29               0       0        0       0       0      0       0       0       0
         30               0       0        0       0       0      0       1       0       0
         31               0       0        0       0       0      0       1       0       0
         32               0       0        0       0       0      0       0       0       0
         33               0       0        0       0       0      0       0       0       0
         36               0       0        0       0       0      0       0       1       1
;

Table    yref(i,p)     PRind_REF process capacity referencing resource indicator for process p

                           1       2        3       4       5             9       10    11    12     14     13      19       18         22       27       23
          1                1       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          2                0       0        0       0       0             0       0     0     1      0      0       0        0          0        0        1
          3                0       1        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          4                0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          5                0       0        1       0       0             0       0     0     0      0      0       0        0          0        0        0
          6                0       0        0       1       0             0       0     0     0      0      0       0        0          0        0        0
          7                0       0        0       0       1             0       0     0     0      0      0       0        0          0        0        0
          8                0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          9                0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          10               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          11               0       0        0       0       0             0       0     0     0      0      0       0        0          1        0        0
          12               0       0        0       0       0             1       0     0     0      0      0       0        0          0        0        0
          13               0       0        0       0       0             0       1     0     0      0      0       0        0          0        0        0
          14               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          15               0       0        0       0       0             0       0     1     0      0      0       0        0          0        0        0
          16               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          17               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          18               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          19               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          20               0       0        0       0       0             0       0     0     0      0      1       0        0          0        0        0
          21               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          22               0       0        0       0       0             0       0     0     0      1      0       0        0          0        0        0
          23               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          24               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          25               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          26               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          27               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          28               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          29               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          30               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          31               0       0        0       0       0             0       0     0     0      0      0       1        1          0        0        0
          32               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          33               0       0        0       0       0             0       0     0     0      0      0       0        0          0        0        0
          35               0       0        0       0       0             0       0     0     0      0      0       0        0          0        1        0

     ;

Table    ghgref(i,p)     REF_PGHG ghg emission factor of resource i processed in process p (kgCO2e per ton)

                      16     17           18            22

          14          10.04  0            0             0
          16          0      13.35        0             0
          2           0      0            0             0
          8           0      0            0             0
          28          0      0            0             0
          31          0      0            0             0
          32          0      0            0             0
          21          0      0            0             0           ;


Table    yintmat(int,i,p)     Rind_INTMAT resource indicator for material consumed that could be delivered via stream int

                          12     22        27
          lpspor.30       0      1         0
          wpor.24         0      1         0
 ;

Table    yintexres(int,i)     Rind_EXRES resource indicator for external resource neglected for delivery via stream int

                   24    29   30
         lpspor    0     0    1;


Table    yintsgres(int,i,p)     Rind_SGRES resource indicator for generated product that could be delivered via stream int

                          15     22     23    27
          effpor.2        0      0      1     0     ;


Table pint(int,sz)   Pind_IS existing intermediate stream int in scenario z

              1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
lpspor        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        1        0        0        1        1        0        0        0        0        0        1        0        0        1        1        0        0        1        1        1        0        0        1        1        1        1        1
wpor          0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        1        0        0        0        0        1        1        0        0        0        1        0        0        0        0        1        1        0        0        1        1        0        1        0        1        1        0        1        1        1
effpor        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        1        0        0        0        0        1        1        0        0        0        1        0        0        0        0        1        1        0        0        1        1        0        1        0        1        1        0        1        1        1
;

Table pexist(p,sz)   Pind_EXIST process indicator for operating process p in scenario z

          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
1         1        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        0        1
2         1        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        0        1
3         1        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        0        1
4         0        1        0        0        0        0        1        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        0        1        1        1        1        0        1        1
5         0        1        0        0        0        0        1        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        0        1        1        1        1        0        1        1
13        0        1        0        0        0        0        1        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        0        1        1        1        1        0        1        1
12        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
14        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
9         0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
10        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
11        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
15        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
22        0        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        1        0        0        0        1        0        0        1        0        1        1        0        0        1        0        1        1        0        1        1        1        0        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1        1
23        0        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        1        0        0        0        1        0        0        1        0        1        1        0        0        1        0        1        1        0        1        1        1        0        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1        1
16        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
17        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
18        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
19        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
27        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
;

Table correlated(p,sz) Pind_REL process indicator for correlated process p in scenario z

          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
1         1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
2         1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
3         1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
4         1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
5         1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
13        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
12        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
14        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
9         0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
10        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
11        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        1        1        0        1        0        0        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1
15        0        0        1        0        0        0        0        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1
22        0        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        1        0        0        0        1        0        0        1        0        1        1        0        0        1        0        1        1        0        1        1        1        0        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1        1
23        0        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        1        0        0        0        1        0        0        1        0        1        1        0        0        1        0        1        1        0        1        1        1        0        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1        1
16        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
17        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
18        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
19        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
27        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        1        0        1        1        1        1        0        1        1        1        1        1
;

Table bypass(p,sz) Pind_BYPASS process indicator for by-passed process p in scenario z

          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
1         0        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        1        0
2         0        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        1        0
3         0        1        1        1        1        1        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        0        0        0        0        0        1        0
4         1        0        1        1        1        1        0        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        1        0        0        0        0        1        0        0
5         1        0        1        1        1        1        0        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        1        0        0        0        0        1        0        0
13        1        0        1        1        1        1        0        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        1        1        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        1        0        0        0        0        1        0        0
12        1        1        0        1        1        1        1        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0
14        1        1        0        1        1        1        1        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0
9         1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        0        0        1        0        1        1        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0
10        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        0        0        1        0        1        1        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0
11        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        1        0        0        1        1        0        1        1        0        1        1        0        0        1        0        1        1        0        0        1        0        0        1        0        0        1        1        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0
15        1        1        0        1        1        1        1        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0
22        1        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        0        1        1        1        0        1        1        0        1        0        0        1        1        0        1        0        0        1        0        0        0        1        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0        0
23        1        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        0        1        1        1        0        1        1        0        1        0        0        1        1        0        1        0        0        1        0        0        0        1        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0        0
16        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
17        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
18        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
19        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
27        1        1        1        1        0        1        1        1        1        0        1        1        1        0        1        1        0        1        0        1        0        1        1        0        1        1        0        1        0        1        0        1        0        1        0        1        0        0        1        0        0        1        0        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
;



Table exgenres(i,sz) Rind_EXGEN (cpores) externally generated resource i
          6        18       20       21       39       40       41       56
11        1        1        1        1        1        1        1        1

 ;

Table exprores(i,sz) Rind_EXPRO unprocessed product i that requires external processing or treatment
          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
2         1        1        0        0        0        1        1        0        1        1        1        0        1        1        1        0        0        0        0        1        1        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0
20        1        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        1        1        1        1        1        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        1        1        1        0        0        0        0        0        0        0        0        0        1        0        0

;

Table addbyind(i,sz) BYind_ADD additional by product indicator i
          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
2         1        1        0        0        0        1        1        0        1        1        1        0        1        1        1        0        0        0        0        1        1        0        1        1        1        0        0        0        1        1        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        1        1        0        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0
11        1        1        0        0        0        0        1        1        1        1        0        1        1        1        0        0        0        0        0        0        0        1        1        1        0        1        1        0        1        0        0        1        1        0        1        0        0        0        0        0        0        1        1        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0        0
12        0        1        0        0        0        0        1        0        0        0        0        1        0        1        1        0        0        0        0        0        0        1        0        1        1        0        0        0        0        0        0        0        1        1        0        0        1        0        0        0        0        0        1        1        0        0        1        0        0        0        0        0        0        1        0        0        0        0        1        0        0        0        0
14        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0
16        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0        0


;

Table excpo(p,sz)   Pind_INT process indicator for integrated milling process p

          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
1         1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
2         1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
3         1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
4         1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
5         1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
13        1        1        1        1        1        0        1        1        1        1        1        1        1        1        1        1        1        0        1        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        0        0        1        1        1        1        1        1        1        1        1        1        1        1        1        1        0        1        1        1        1        1        1        1
9         1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
10        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
11        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
12        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
14        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
15        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
16        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
17        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
18        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
19        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
22        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
23        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1
27        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1        1

;
Table rforce(i,sz)   Rind_FORCE resource indicator for forced feed resource i consumption during stand-alone process operation

          1        2        3        4        5        6        7        8        9        10       11       12       13       14       15       16       17       18       19       20       21       22       23       24       25       26       27       28       29       30       31       32       33       34       35       36       37       38       39       40       41       42       43       44       45       46       47       48       49       50       51       52       53       54       55       56       57       58       59       60       61       62       63
12        0        0        0        1        0        0        0        0        0        0        0        0        0        0        0        1        0        0        1        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        1        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0        0
14        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0
16        0        0        0        0        1        0        0        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        1        0        0        0        1        0        0        1        0        0        1        0        0        0        1        0        0        1        0        0        0        1        0        0        0        0        1        0        0        0        0
;



POSITIVE VARIABLES

mat(i,p)         amount of input material i fed into process t  (tons per hr)
res(i)           amount of system resource i (tons per hr)
sgres(i,p)       amount of output resource i from process t  (tons per hr)
exres(i)         amount of external resource i  (tons per hr)
pres(p)          amount of resource in process t  (tons per hr)
pro(i)           amount of system product i (tons per hr)
rev(i)           resource revenue  (USD)
cost(i)          material cost     (USD)
capres(p)        process capacity of process p (tons per hr)
opex             annual operating cost of POBC (USD per y)
elecdem          total electricity demand for POBC (MWh)
exelec           external electricity imported (MWh)
eleccost         total cost for importing grid electricity (USD)
elecrev          revenue for selling grid electricity under FiT scheme (USD)
excesselec       amount of self-generated electricity in excess (MWh)
lamda            aggregate degree of satisfaction
bwfp             blue water footprint (tons per hr)
gwfp             grey water footprint (tons per hr)
eff              total effluent generated (tons per hr)
wfp              total WFP (t per h)
etranscost       total capital cost for power transmission line (USD)
intflow(int)     flowrate of intermediate stream int (tons per hr)
intpc(int)       piping cost for intermediate stream int (USD)
totalintpc       total pipeline construction cost for all streams (USD)
intpumpc(int)    fixed costs for pump motor and valves to pump stream int (USD)
totalpumpc       Total pumping cost for all streams (USD)
totalpipecost    Total piping cost for all streams (USD)
extres(i)        Additional availability of external resource (t per h)
avres(i)         Overall availability of external resource (t per h)
;

variables
obj(f)           objective function
energybal        net energy
z                final objective function
finalghg         final GHG footprint of POBC  (kgCO2e per h)
processghg(p)    net GHG emission from process p (kgCO2e per h)
tprocessghg      total net GHG emission from all operating processes (kgCO2e per h)
resourceghg      net GHG emission from all consumed and generated resources (kgCO2e per h)
extcost(i)
finalgp          final gross profit of POBC considering external resource processing costs (USD per y)
aprofit          annual profit of value chain (USD per y)
profit           profit of value chain (RM)
grossp           annual gross profit of POBC (USD per y)
;


binary variable
ysurelec         surplus electricity indicator
yexelec          external electricity indicator
yexres(i)        external resource indicator
ypro(i)          product indicator

Integer variable
cap(p)           number of operating units for process p
;

EQUATIONS

resbal(i)                input resource definition in system resource balance
elebal(i)                output resource definition in system resource balance
ratio(i,p)               input material composition for material balance around a process
convbal(i,p)             output resource composition for material balance around a process
productdemand(i)         product flowrate inequality constraint
feedstockbal(i)          resource availability constraint
extresbal(i)             additional process external resource availability balance
feedstockbal2(i)         external resource availability balance
feedstockbal3(i)         forced feed resource consumption balance
first(i)                 primary raw material availability constraint
byproduct(i)             product definition constraint
probal(i)                external resource flowrate limiting constraint
probal2(i)               product flowrate limiting constraint
probal3(i)               logical constraint for external resource and product binary variables
resrefer(p)              minimum process capacity constraint
processcapacity(p)       lower bound constraint for process sizing
newcapbal(p)             maximum process unit constraint
elecdemand               POBC electricity demand constraint
externalpower            electricity balance constraint
powerbal                 excess electricity limiting constraint
powerbal2                external electricity limiting constraint
powerbal3                logical constraint for external and excess electricity
yintbal(int)             intermediate resource balance constraints
exreslim(i)              limiting constraint for external intermediate resource
intpcbal(int)            pipeline capital cost for intermediation stream int
totalintpcbal            total pipeline construction cost constraint
intpumpcbal(int)         fixed cost for pump motor and valves for intermediate stream int
totalintpumpbal          total fixed cost costraint for pumping system
totalpipecbal            total capital cost constraint for piping infrastructure
elecrevenue              Fit revenue constraint
extcostbal(i)            external processing costing constraint
MAXPROFIT                resource value chain profit
annualprofit             annual profit based on resource and electricity
revenue(i)               product revenue
rescost(i)               external material cost
opcost                   operating cost constraint
grossprofit              annual profit balance without external processing cost
GPBAL                    final annual gross profit constraint
expowercost              electricity cost constraint
netenergy                net energy balance constraint
processghgbal(p)         total GHG emission from each process p
processghgbal2           total GHG emission from all processes
resourceghgbal           total GHG emission from all external resources and waste by-product
ghgbal                   Overall GHG emission rate on an hourly basis
effbal                   effluent balance
waterbal                 blue WFP constraint
waterbal2                grey WFP constraint
waterbal3                total water footprint constraint
pobj                     ultimate objective function
objGP                    gross profit objective function
objNE                    net energy objective function
objGHG                   GHG balance objective function
objWFP                    WFP objective function
;

elebal(i)..               res(i)=e=sum((p),mat(i,p))+ pro(i) ;
resbal(i)..               res(i)=e=sum((p),sgres(i,p))+ exres(i);
ratio(i,p)..              mat(i,p)=e=pres(p)*(mcm(i,p)-(bymcm(i,p))*(bypass_AUX(p)));
convbal(i,p)..            pres(p)*prcm(i,p)*((relprind(i,p)*correlated_AUX(p))-(byprcm(i,p)*bypass_AUX(p))) =e= sgres(i,p);
productdemand(i)..        dempro(i) =l= pro(i);
feedstockbal(i)..         avres(i) =g= exres(i);
extresbal(i)..            extres(i) =e= sum(p,pextres(i,p)*bypass_AUX(p));
feedstockbal2(i)..        localavres(i) + extres(i) =e= avres(i);
first(i)..                res('1')=g= avres('1')*pfirst_AUX ;
feedstockbal3(i)..        res(i) =g= extres(i)*rforce_AUX(i) ;
byproduct(i)..            pro(i) =l= (addbyind_AUX(i)+ byind(i))*alpha;
probal(i)..               exres(i) =l= alpha*yexres(i);
probal2(i)..              pro(i) =l= alpha*ypro(i);
probal3(i)..              yexres(i) + ypro(i) =l= 1;
resrefer(p)..             capres(p)=e= sum(i,yref(i,p)*mat(i,p))+sum(i,yref(i,p)*sgres(i,p)) ;
processcapacity(p)..      cap(p)*descap(p) =g= capres(p)*pexist_AUX(p)  ;
newcapbal(p)..            cap(p) =l= maxcap(p)*pexist_AUX(p);
elecdemand..              elecdem =e= sum(p,cap(p)*uelecdem(p)*pexist_AUX(p));
externalpower..           excesselec + elecdem =e= exelec + sum(i,pro(i)*elecind(i))  ;
powerbal..                excesselec =l= alpha*ysurelec;
powerbal2..               exelec =l= alpha*yexelec;
powerbal3..               ysurelec + yexelec =e= 1;
yintbal(int)..            intflow(int) =e= pint_AUX(int)*(sum((i,p),mat(i,p)*yintmat(int,i,p)) + sum((i,p),sgres(i,p)*yintsgres(int,i,p))- sum(i,exres(i)*yintexres(int,i))) ;
exreslim(i)..             sum(int,pint_AUX(int)*exres(i)*yintexres(int,i)) =l= sum((int,p),pint_AUX(int)*mat(i,p)*yintmat(int,i,p));
intpcbal(int)..           intpc(int) =e= uintpcost(int)*disint(int)*pint_AUX(int);
totalintpcbal..           totalintpc =e= sum(int,intpc(int));
intpumpcbal(int)..        intpumpc(int) =e= ((3.145*(intflow(int)))+(pint_AUX(int)*317.593)) + ((2.22*(intflow(int)))+(pint_AUX(int)*3.69))+ ((0.616*(intflow(int)))+(pint_AUX(int)*712.55)) ;
totalintpumpbal..         totalpumpc =e= sum(int,intpumpc(int));
totalpipecbal..           totalpipecost =e= totalintpc + totalpumpc;
elecrevenue..             elecrev =e= excesselec*FiT ;
extcostbal(i)..           extcost(i) =e= uextcost(i)*sum(p,sgres(i,p)*((bypass_AUX(p))*externalpol(i,p)*excpo_AUX(p)))+ uextcost(i)*exprores_AUX(i)*sum(p,sgres(i,p)) + (sum(p,sgres(i,p))*exgenres_AUX(i)*price(i)) ;
MAXPROFIT ..              profit =e= sum(i,price(i)*pro(i))- sum(i,urcost(i)*exres(i));
annualprofit..            aprofit =e= AOT*(profit - eleccost + elecrev)  ;
revenue(i)..              price(i)*pro(i)=e= rev(i);
rescost(i)..              urcost(i)*exres(i)=e= cost(i);
opcost..                  opex =e= sum(p,cap(p)*uopex(p)*pexist_AUX(p));
grossprofit..             grossp =e= aprofit - opex - MCF*totalpipecost;
GPBAL..                   finalgp =e= grossp - AOT*sum(i,extcost(i)) ;
expowercost..             eleccost =e= exelec*electariff ;
netenergy..               energybal =e= excesselec - exelec  ;
processghgbal(p)..        processghg(p) =e= sum(i,ghgref(i,p)*mat(i,p))+sum(i,ghgref(i,p)*sgres(i,p));
processghgbal2..          tprocessghg =e= sum(p,processghg(p)*pexist_AUX(p));
resourceghgbal..          resourceghg =e= (sum(i,ghgresind(i)*exres(i)))+(sum(i,ghgproind(i)*pro(i)))+ GEF*exelec;
ghgbal..                  finalghg =e= tprocessghg + resourceghg;
effbal..                  eff =e= sum(i,effind(i)*pro(i));
waterbal..                bwfp =e= sum(i,fwind(i)*exres(i));
waterbal2..               gwfp =e= ((ceff-cact)/(cmax-cnat))*eff;
waterbal3..               wfp =e= bwfp + gwfp;
pobj..                    z =e= obj('1');
objWFP..                  obj('4') =e= wfp + 0 ;
objNE..                   obj('2') =e= energybal;
objGP..                   obj('1') =e= finalgp;
objGHG..                  obj('3') =e= finalghg + 0 ;

option optcr = 0;
MODEL pobc/ALL/;

loop(sz,
pexist_AUX(p) = pexist(p,sz);
correlated_AUX(p) = correlated(p,sz);
bypass_AUX(p) = bypass(p,sz);
pfirst_AUX = pfirst(sz);
exprores_AUX(i) = exprores(i,sz);
exgenres_AUX(i) = exgenres(i,sz);
addbyind_AUX(i) = addbyind(i,sz);
excpo_AUX(p) = excpo(p,sz);
pint_AUX(int) = pint(int,sz)   ;
rforce_AUX(i) = rforce(i,sz);

SOLVE pobc MAXIMISING z using MIP ;

         Model_Objective(sz) = z.L;

Display Model_Objective;

);
